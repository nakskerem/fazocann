<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ä°yi ki DoÄŸdun Fazocan!</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
<style>
body {
  margin:0;
  padding:0;
  font-family: 'Poppins', sans-serif;
  background: linear-gradient(135deg, #fdfdfd, #e6f0ff);
  display:flex;
  flex-direction:column;
  align-items:center;
  min-height:100vh;
  overflow:hidden;
}
h1 {
  margin-top:50px;
  color:#333;
  font-size:3em;
  text-shadow:0 3px 7px rgba(0,0,0,0.15);
  text-align:center;
}
#instruction {
  margin-top:10px;
  font-size:1.2em;
  color:#222;
  background: rgba(255,255,255,0.9);
  padding:8px 12px;
  border-radius:8px;
  box-shadow:0 2px 6px rgba(0,0,0,0.15);
  text-align:center;
}
#cake {
  position: relative;
  margin:30px auto;
  width:380px;
  height:180px;
  background: #fff;
  border-radius:25px;
  box-shadow:0 15px 30px rgba(0,0,0,0.2);
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  padding: 20px;
}
.candle {
  position: relative;
  width:12px;
  height:60px;
  background: linear-gradient(to top, #ffd54f, #ffca28);
  border-radius:6px;
  cursor:pointer;
  display:flex;
  justify-content:center;
}
.flame {
  position:absolute;
  top:-20px;
  width:12px;
  height:20px;
  background: radial-gradient(circle, #ffeb3b 0%, #ff9800 60%, rgba(255,152,0,0) 100%);
  border-radius:50%;
  animation: flicker 0.2s infinite alternate;
  transform-origin: bottom center;
}
@keyframes flicker {
  0% { transform: scaleY(1) rotate(0deg); opacity:1;}
  100% { transform: scaleY(0.85) rotate(2deg); opacity:0.8;}
}
#letterBtn {
  margin-top:30px;
  padding:12px 24px;
  font-size:1.2em;
  border:none;
  border-radius:12px;
  background: linear-gradient(135deg, #ff6b6b, #ff4757);
  color:white;
  cursor:pointer;
  box-shadow:0 5px 15px rgba(0,0,0,0.2);
  transition:0.3s;
}
#letterBtn:hover { transform: scale(1.05);}
#message {
  display:none;
  margin-top:20px;
  background: rgba(255,255,255,0.95);
  padding:20px 30px;
  border-radius:15px;
  font-size:1.3em;
  color:#333;
  box-shadow:0 8px 25px rgba(0,0,0,0.2);
  max-width:80%;
  text-align:center;
}
#surprise {
  display:none;
  margin-top:20px;
  font-size:1.5em;
  color:#ff6b6b;
  font-weight:bold;
  text-align:center;
}
#musicBtn {
  margin-top:20px;
  padding:10px 20px;
  font-size:1em;
  border:none;
  border-radius:10px;
  background: #4b7bec;
  color:white;
  cursor:pointer;
  box-shadow:0 3px 8px rgba(0,0,0,0.15);
}
canvas {
  position: fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  pointer-events:none;
  z-index:999;
}
</style>
</head>
<body>

<h1>ðŸŽ‰ Ä°yiâ€¯kiâ€¯DoÄŸdunâ€¯Fazocan! ðŸŽ‚</h1>
<div id="instruction">DileÄŸini dile ve tÄ±klayarak sÃ¶ndÃ¼r</div>

<div id="cake"></div>

<button id="letterBtn">Mektup AÃ§</button>
<div id="message">
  DoÄŸum gÃ¼nÃ¼n kutlu dostluÄŸumuz baki olsun. Hep olman, hep iyi ki olman dileÄŸiyleâ€¦
</div>

<div id="surprise">1â€¯sÃ¼rprizim daha var. Oyuna girmelisin onu gÃ¶rmek iÃ§in.</div>
<button id="musicBtn">MÃ¼ziÄŸi BaÅŸlat</button>

<canvas id="animationCanvas"></canvas>

<script>
const cake = document.getElementById('cake');
const letterBtn = document.getElementById('letterBtn');
const message = document.getElementById('message');
const surprise = document.getElementById('surprise');
const musicBtn = document.getElementById('musicBtn');
const canvas = document.getElementById('animationCanvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let candlesLit = 19;
const flames = [];

// MumlarÄ± oluÅŸtur
for(let i=0;i<19;i++){
  const candle = document.createElement('div');
  candle.classList.add('candle');
  const flame = document.createElement('div');
  flame.classList.add('flame');
  candle.appendChild(flame);
  cake.appendChild(candle);
  flames.push(flame);

  candle.addEventListener('click',()=>{
    if(flame.style.display !== 'none'){
      flame.style.display='none';
      candlesLit--;
      if(candlesLit===0){
        startConfetti();
        launchBalloons();
        surprise.style.display='block';
      }
    }
  });
}

// Confetti particle sistemi
const confettiParticles=[];
function startConfetti(){
  for(let i=0;i<200;i++){
    confettiParticles.push({
      x:Math.random()*canvas.width,
      y:Math.random()*canvas.height - 200,
      size:Math.random()*8+3,
      speed:Math.random()*4+2,
      angle:Math.random()*360,
      color:`hsl(${Math.random()*360},100%,50%)`,
      tilt:Math.random()*10-5
    });
  }
  requestAnimationFrame(drawConfetti);
}

function drawConfetti(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  confettiParticles.forEach(p=>{
    ctx.save();
    ctx.fillStyle=p.color;
    ctx.translate(p.x,p.y);
    ctx.rotate(p.angle*Math.PI/180);
    ctx.fillRect(-p.size/2,-p.size/2,p.size,p.size);
    ctx.restore();
    p.y += p.speed;
    p.angle += 2;
    if(p.y>canvas.height) p.y=0;
  });
  requestAnimationFrame(drawConfetti);
}

// Balonlar
const balloons=[];
function launchBalloons(){
  for(let i=0;i<15;i++){
    balloons.push({
      x:Math.random()*(canvas.width-100)+50,
      y:canvas.height + 50 + Math.random()*100,
      radiusX:25,
      radiusY:35,
      speed:1 + Math.random()*1.5,
      color: '#ff6b6b',
      sway: 2 + Math.random()*1,
      swayDir: Math.random()<0.5 ? -1 : 1
    });
  }
  requestAnimationFrame(drawBalloons);
}

function drawBalloons(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  confettiParticles.forEach(p=>{
    ctx.save();
    ctx.fillStyle=p.color;
    ctx.translate(p.x,p.y);
    ctx.rotate(p.angle*Math.PI/180);
    ctx.fillRect(-p.size/2,-p.size/2,p.size,p.size);
    ctx.restore();
    p.y += p.speed;
    p.angle += 2;
    if(p.y>canvas.height) p.y=0;
  });
  
  balloons.forEach(b=>{
    b.x += Math.sin(b.y/60)*b.swayDir*b.sway;
    b.y -= b.speed;
    // ip
    ctx.beginPath();
    ctx.moveTo(b.x,b.y + b.radiusY);
    ctx.lineTo(b.x, b.y + b.radiusY + 60);
    ctx.strokeStyle='rgba(0,0,0,0.3)';
    ctx.lineWidth=1.5;
    ctx.stroke();
    // balon
    ctx.beginPath();
    ctx.ellipse(b.x, b.y, b.radiusX, b.radiusY, 0, 0, 2*Math.PI);
    const grd = ctx.createRadialGradient(b.x, b.y-5,5, b.x, b.y, Math.max(b.radiusX, b.radiusY));
    grd.addColorStop(0,'#fff');
    grd.addColorStop(1,b.color);
    ctx.fillStyle = grd;
    ctx.fill();
    ctx.strokeStyle='rgba(0,0,0,0.1)';
    ctx.stroke();
  });
  
  const allGone = balloons.every(b => b.y + b.radiusY < -20);
  if(!allGone) {
    requestAnimationFrame(drawBalloons);
  }
}

// Web Audio API ile Happy Birthday
let audioCtx;
let isPlaying = false;
const notes = [
  {freq:264, dur:400},{freq:264, dur:400},{freq:297, dur:800},{freq:264, dur:800},{freq:352, dur:800},{freq:330, dur:1600},
  {freq:264, dur:400},{freq:264, dur:400},{freq:297, dur:800},{freq:264, dur:800},{freq:396, dur:800},{freq:352, dur:1600},
  {freq:264, dur:400},{freq:264, dur:400},{freq:528, dur:800},{freq:440, dur:800},{freq:352, dur:800},{freq:330, dur:800},{freq:297, dur:1600}
];

let currentNote = 0;
let timeoutId;

function playNextNote(){
  if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  const note = notes[currentNote];
  const osc = audioCtx.createOscillator();
  const gain = audioCtx.createGain();
  osc.connect(gain);
  gain.connect(audioCtx.destination);
  osc.type = 'sine'; // Daha yumuÅŸak ton
  osc.frequency.value = note.freq;
  gain.gain.setValueAtTime(0.2, audioCtx.currentTime);
  osc.start();
  osc.stop(audioCtx.currentTime + note.dur/1000);
  currentNote = (currentNote + 1) % notes.length;
  timeoutId = setTimeout(playNextNote, note.dur);
}

function startMusic(){
  if(!isPlaying){
    isPlaying = true;
    playNextNote();
  }
}

function stopMusic(){
  isPlaying = false;
  clearTimeout(timeoutId);
}

musicBtn.addEventListener('click', ()=>{
  if(!isPlaying){
    startMusic();
    musicBtn.innerText = 'MÃ¼ziÄŸi Durdur';
  } else {
    stopMusic();
    musicBtn.innerText = 'MÃ¼ziÄŸi BaÅŸlat';
  }
});

// Mektup aÃ§ma
letterBtn.addEventListener('click', ()=>{
  message.style.display = (message.style.display==='block') ? 'none' : 'block';
});
</script>
</body>
</html>
